<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catch the Emojis!</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 1rem;
            flex-direction: column;
            overflow: hidden; /* Prevent scrolling */
        }
        .game-container {
            background-color: #ffffff;
            border-radius: 1rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            max-width: 95%;
            width: 500px;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        canvas {
            background-color: #e0f2fe;
            border: 2px solid #3b82f6;
            border-radius: 0.75rem;
            touch-action: none; /* Disable default touch actions like scrolling */
        }
        .header {
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding: 0.5rem 1rem;
            font-size: 1.25rem;
            font-weight: bold;
            color: #1f2937;
        }
        .message-box {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(255, 255, 255, 0.95);
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.2);
            text-align: center;
            z-index: 100;
        }
        .message-box h2 {
            font-size: 2.25rem;
            font-weight: bold;
            margin-bottom: 1rem;
            color: #4b5563;
        }
        .message-box button {
            background-color: #3b82f6;
            color: white;
            padding: 0.75rem 2rem;
            border-radius: 0.5rem;
            font-weight: bold;
            transition: transform 0.1s ease;
        }
        .message-box button:hover {
            background-color: #2563eb;
        }
        .message-box button:active {
            transform: scale(0.95);
        }
    </style>
</head>
<body>

    <div class="game-container">
        <div class="header">
            <span id="score-display">Score: 0</span>
            <span id="lives-display">Lives: 3</span>
        </div>
        <canvas id="gameCanvas"></canvas>
    </div>

    <div id="message-container" class="hidden">
        <div class="message-box">
            <h2 id="message-text"></h2>
            <button id="restart-button">Play Again</button>
        </div>
    </div>

    <script>
        window.onload = function() {
            // Game variables and setup
            const canvas = document.getElementById('gameCanvas');
            const ctx = canvas.getContext('2d');
            const scoreDisplay = document.getElementById('score-display');
            const livesDisplay = document.getElementById('lives-display');
            const messageContainer = document.getElementById('message-container');
            const messageText = document.getElementById('message-text');
            const restartButton = document.getElementById('restart-button');

            let score = 0;
            let lives = 3;
            let gameOver = false;
            let emojiInterval;
            let lastTime = 0;
            const emojiSpawnRate = 1000; // ms
            let nextEmojiSpawn = 0;
            let emojis = [];
            
            // Player basket
            const basket = {
                x: 0,
                y: 0,
                width: 80,
                height: 30,
                color: '#3b82f6',
                emoji: 'ðŸ§º'
            };

            // Emojis to fall
            const catchableEmojis = ['ðŸŽ', 'ðŸ“', 'ðŸ‡', 'ðŸ‰', 'ðŸŒ', 'ðŸ'];
            const bombEmojis = ['ðŸ’£', 'ðŸ’€', 'ðŸ’©'];
            const emojiSize = 30;

            // Handle touch and mouse events for mobile and desktop
            let touchX = 0;
            let touchY = 0;

            canvas.addEventListener('mousemove', (e) => {
                if (!gameOver) {
                    const rect = canvas.getBoundingClientRect();
                    touchX = e.clientX - rect.left;
                }
            });

            canvas.addEventListener('touchmove', (e) => {
                if (!gameOver) {
                    e.preventDefault();
                    const touch = e.touches[0];
                    const rect = canvas.getBoundingClientRect();
                    touchX = touch.clientX - rect.left;
                }
            }, { passive: false });

            // Keyboard controls for desktop
            document.addEventListener('keydown', (e) => {
                if (!gameOver) {
                    if (e.key === 'ArrowLeft' || e.key === 'a') {
                        basket.x -= 20;
                    } else if (e.key === 'ArrowRight' || e.key === 'd') {
                        basket.x += 20;
                    }
                    // Keep basket within canvas bounds
                    basket.x = Math.max(0, Math.min(canvas.width - basket.width, basket.x));
                }
            });

            restartButton.addEventListener('click', startGame);

            function showMessage(text) {
                messageText.textContent = text;
                messageContainer.classList.remove('hidden');
            }

            function hideMessage() {
                messageContainer.classList.add('hidden');
            }

            function createEmoji() {
                // Randomly choose between a good emoji and a bomb
                const isBomb = Math.random() < 0.2; // 20% chance of a bomb
                const emojiArray = isBomb ? bombEmojis : catchableEmojis;
                const emoji = emojiArray[Math.floor(Math.random() * emojiArray.length)];
                
                emojis.push({
                    x: Math.random() * (canvas.width - emojiSize),
                    y: -emojiSize,
                    emoji: emoji,
                    speed: 2 + Math.random() * 2, // Random speed
                    isBomb: isBomb
                });
            }
            
            function update() {
                // Update basket position based on touch/mouse
                if (touchX > 0) {
                    basket.x = touchX - basket.width / 2;
                    // Keep basket within canvas bounds
                    basket.x = Math.max(0, Math.min(canvas.width - basket.width, basket.x));
                }

                // Update falling emojis
                for (let i = emojis.length - 1; i >= 0; i--) {
                    const emoji = emojis[i];
                    emoji.y += emoji.speed;

                    // Collision detection with basket
                    if (
                        emoji.y + emojiSize > basket.y &&
                        emoji.x > basket.x &&
                        emoji.x < basket.x + basket.width
                    ) {
                        if (emoji.isBomb) {
                            lives--;
                            if (lives <= 0) {
                                gameOver = true;
                                showMessage('Game Over! You caught a bomb.');
                            }
                        } else {
                            score++;
                        }
                        emojis.splice(i, 1);
                    } else if (emoji.y > canvas.height) {
                        // Emoji missed
                        if (!emoji.isBomb) {
                            lives--;
                            if (lives <= 0) {
                                gameOver = true;
                                showMessage('Game Over! You missed too many.');
                            }
                        }
                        emojis.splice(i, 1);
                    }
                }
            }

            function draw() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                // Draw falling emojis
                ctx.font = `${emojiSize}px serif`;
                emojis.forEach(emoji => {
                    ctx.fillText(emoji.emoji, emoji.x, emoji.y);
                });

                // Draw basket
                ctx.font = `${basket.width}px serif`;
                ctx.fillText(basket.emoji, basket.x, basket.y);
            }

            function gameLoop(timestamp) {
                if (!gameOver) {
                    const deltaTime = timestamp - lastTime;
                    lastTime = timestamp;

                    if (timestamp > nextEmojiSpawn) {
                        createEmoji();
                        nextEmojiSpawn = timestamp + emojiSpawnRate;
                    }

                    update();
                    draw();
                    scoreDisplay.textContent = `Score: ${score}`;
                    livesDisplay.textContent = `Lives: ${lives}`;
                    requestAnimationFrame(gameLoop);
                }
            }

            function resizeCanvas() {
                canvas.width = Math.min(window.innerWidth * 0.9, 500);
                canvas.height = Math.min(window.innerHeight * 0.6, 600);
                basket.y = canvas.height - 50; // Keep basket at the bottom
            }

            function startGame() {
                score = 0;
                lives = 3;
                emojis = [];
                gameOver = false;
                hideMessage();
                resizeCanvas();
                basket.x = (canvas.width / 2) - (basket.width / 2); // Center basket
                requestAnimationFrame(gameLoop);
            }

            window.addEventListener('resize', resizeCanvas);
            startGame();
        };
    </script>
</body>
</html>